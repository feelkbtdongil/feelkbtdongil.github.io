import{Q as G}from"./QBar.aa6ab1e6.js";import{Q as P}from"./QSpace.d904af94.js";import{Q as L}from"./QToolbar.963c8e72.js";import{r,k as U,S as E,U as w,a8 as W,n as s,j as Z,ad as Q,p as X,o as K,V,W as i,a7 as ee,$ as g,Y as n,a5 as h,ab as te,a2 as x,Z as y,a9 as O,a1 as ae,bu as se,bE as oe,X as le,aa as ne}from"./index.7f77393b.js";/* empty css                        */import{A as re}from"./main.esm.3000f5c9.js";import{u as ie}from"./use-quasar.49a49e75.js";import{l as D}from"./lodash.de417675.js";import{j as R,n as de}from"./json-util.159ec565.js";import{Q as ue}from"./QSelect.114f76c2.js";import{u as ce}from"./setYearInfo.8b7f3a45.js";import"./_commonjsHelpers.b8add541.js";import"./QField.5fb0fda7.js";import"./QItemSection.f93cdc59.js";import"./QItemLabel.4a9918b4.js";import"./QMenu.0a3c81a9.js";import"./position-engine.150cbc63.js";import"./selection.004dbe93.js";import"./rtl.276c3f1b.js";const me={key:0},pe={key:1},fe={__name:"CompSelectDepg",props:["params"],setup(b){const f=b,d=r(f.params.data),{updateSelectedValue:_}=f.params,C=r(null),m=()=>{_(d)};U(()=>{o()});const o=async()=>{try{const u=await E.post("/api/mst/comm_option_list",{paramCommCd1:"101"});C.value=u.data.data}catch(u){console.error("Error fetching users:",u)}};return(u,l)=>d.value?(w(),W("div",me,[s(ue,{dense:"","options-dense":"",modelValue:d.value.depgCd,"onUpdate:modelValue":[l[0]||(l[0]=c=>d.value.depgCd=c),m],options:C.value,"option-value":"commCd","option-label":"commNm","emit-value":"","map-options":""},null,8,["modelValue","options"])])):(w(),W("div",pe))}},ve={class:"row q-col-gutter-md"},he={class:"col-12"},ge=g("span",{class:"text-subtitle2 q-px-sm"},"\uC18C\uC18D\uD300\uC815\uBCF4\uB9AC\uC2A4\uD2B8",-1),we={class:"q-gutter-xs"},Ue={__name:"MstV2020",setup(b){const f=ce(),d=ie(),_=r(500),C=Z(()=>({height:`${_.value}px`})),m=r(null),o=Q({rows:[]}),u=r([]),l=r([]),c=r(!1),S=r(!1);X(()=>{window.removeEventListener("resize",k)}),U(()=>{B.value="multiple",N()}),K(()=>{window.addEventListener("resize",k),k()});const Y=e=>{m.value=e.api},$=Q({def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!0}}),A=Q({columns:[{headerName:"",field:"",maxWidth:50,minWidth:50,checkboxSelection:!0,headerCheckboxSelection:!0,filter:!1,pinned:"left"},{headerName:"\uCF54\uB4DC",field:"deptCd",maxWidth:80,minWidth:80,cellEditorParams:{maxLength:5}},{headerName:"\uD56D\uBAA9\uBA85",field:"deptNm",maxWidth:150,minWidth:150},{headerName:"\uC18C\uC18D\uBD84\uB958",field:"depgCd",minWidth:120,maxWidth:120,filter:!0,editable:!1,cellRenderer:fe,cellRendererParams:{updateSelectedValue:e=>{q()}}},{headerName:"\uCC98\uB9AC\uC21C\uC11C",field:"seq",maxWidth:100,minWidth:100,cellEditor:"agNumberCellEditor",cellEditorParams:{precision:2,step:1,showStepperButtons:!0}}]}),v=r(),I=e=>{v.value=e.api.getSelectedRows(),v.value.length===1?(S.value=!0,c.value=!0):v.value.length>1?(S.value=!0,c.value=!1):S.value=!1},q=()=>{l.value=[];for(let e=0;u.value.length>e;e++)JSON.stringify(u.value[e])!==JSON.stringify(o.rows[e])&&o.rows[e].iuD==="U"&&l.value.push(o.rows[e]);l.value.length>0&&(c.value=!0)},B=r(null),M=()=>{c.value=!0,l.value=[];const e=0,a={stdYear:f.setYear,deptCd:"",oldDeptCd:"",deptNm:"",depgNm:"",depgCd:"1011003",seq:o.rows.length+1,iuD:"I"};o.rows.splice(e,0,a),m.value.setRowData(o.rows),m.value.setFocusedCell(e,"deptCd")},j=()=>{d.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],a=[];for(let p=0;p<v.value.length;p++){let F='{"mode":"D","data":'+JSON.stringify(v.value[p])+"}";a.push(F)}J(R.jsonFiller(e,a));const t=m.value.getSelectedRows();m.value.applyTransaction({remove:t})}).onCancel(()=>{}).onDismiss(()=>{})},H=()=>{let e=[],a=[];for(let t=0;t<o.rows.length;t++)if(!D.exports.isEmpty(o.rows[t].deptCd)&&o.rows[t].iuD==="I"){let p='{"mode": "'+o.rows[t].iuD+'","data":'+JSON.stringify(o.rows[t])+"}";e.push(p)}for(let t=0;t<l.value.length;t++)if(!D.exports.isEmpty(l.value[t].deptCd)&&l.value[t].iuD==="U"){let p='{"mode": "'+l.value[t].iuD+'","data":'+JSON.stringify(l.value[t])+"}";e.push(p)}console.log("iu ::: ",JSON.stringify(e)),D.exports.isEmpty(e)&&D.exports.isEmpty(a)?d.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(J(R.jsonFiller(e,a)),setTimeout(()=>{N()},500))},z=r(0),T=e=>(z.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),k=()=>{_.value=window.innerHeight-z.value-180},N=async()=>{try{const e=await E.post("/api/mst/mst2020_list",{paramSetYear:f.setYear});o.rows=e.data.data,u.value=JSON.parse(JSON.stringify(e.data.data)),l.value=[]}catch(e){console.error("Error fetching users:",e)}},J=e=>{E.post("/api/mst/mst2020_save",e).then(a=>{let t={};a.data.rtn==="0"?(t.rtn=1,t.rtn1=a.data.rtnMsg1,t.rtn2="\uC790\uB8CC\uC800\uC7A5 \uC644\uB8CC"):(t.rtn=a.data.rtn,t.rtn1=a.data.rtnMsg1,t.rtn2=a.data.rtnMsg2),c.value=!1,de.notifyView(t)}).catch(a=>{console.log("error: ",a)})};return(e,a)=>(w(),V(ee,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":T},{default:i(()=>[g("div",ve,[g("div",he,[s(ne,{bordered:""},{default:i(()=>[s(G,{class:"q-px-sm"},{default:i(()=>[s(n(h),{name:"list_alt"}),ge]),_:1}),s(te,{align:"right",class:"q-pa-none"},{default:i(()=>[s(L,{class:"row"},{default:i(()=>[s(n(x),{outline:"",color:"positive",dense:"",onClick:N},{default:i(()=>[s(n(h),{name:"refresh",size:"xs",class:"q-mr-sm"}),y("\uB2E4\uC2DC\uBD88\uB7EC\uC624\uAE30")]),_:1}),s(P),g("div",we,[S.value?(w(),V(n(x),{key:0,outline:"",color:"negative",dense:"",onClick:j},{default:i(()=>[s(n(h),{name:"delete",size:"xs"}),y(" \uC0AD\uC81C")]),_:1})):O("",!0),c.value?(w(),V(n(x),{key:1,outline:"",color:"primary",dense:"",onClick:H},{default:i(()=>[s(n(h),{name:"save",size:"xs"}),y(" \uC800\uC7A5 ")]),_:1})):O("",!0),s(n(x),{outline:"",color:"positive",dense:"",onClick:M},{default:i(()=>[s(n(h),{name:"add",size:"xs"}),y(" \uC2E0\uADDC ")]),_:1})])]),_:1})]),_:1}),s(ae,{size:"3px"}),s(se,{class:"q-pa-xs"},{default:i(()=>[g("div",{style:oe(C.value)},[s(n(re),{ref:"myGrid",style:{width:"100%",height:"100%"},class:le(n(d).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:A.columns,rowData:o.rows,defaultColDef:$.def,rowSelection:B.value,onSelectionChanged:I,onCellValueChanged:q,onGridReady:Y},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})])])]),_:1}))}};export{Ue as default};
