import{Q as He}from"./QBanner.24b401f7.js";import{Q as A}from"./QSpace.d904af94.js";import{r as n,U as u,a8 as y,n as t,W as r,a5 as h,Z as _,a0 as K,a2 as b,ad as k,w as Je,j as Te,p as Fe,k as Me,o as Ge,S as W,a7 as Pe,af as $e,F as je,aa as E,$ as i,X as U,Y as s,a1 as $,bu as j,V as Q,a9 as x,bE as ne,a6 as N,bO as Le,I as L,ab as Ze}from"./index.7f77393b.js";import{Q as Ke}from"./QItemLabel.4a9918b4.js";import{Q as Xe}from"./QBadge.449d79cc.js";import{Q as ie}from"./QToolbar.963c8e72.js";import{Q as ea}from"./QTooltip.472888d5.js";import{Q as aa}from"./QBar.aa6ab1e6.js";import{Q as la}from"./QSelect.114f76c2.js";import{C as Z}from"./ClosePopup.a28dc14a.js";/* empty css                        */import{A as de}from"./main.esm.3000f5c9.js";import{l as ta}from"./lodash.de417675.js";import{j as I,n as ue}from"./json-util.159ec565.js";import{u as oa}from"./use-quasar.49a49e75.js";import{u as sa}from"./setUserInfo.19c8fe66.js";import{u as ra}from"./setYearInfo.8b7f3a45.js";import"./position-engine.150cbc63.js";import"./selection.004dbe93.js";import"./QField.5fb0fda7.js";import"./QItemSection.f93cdc59.js";import"./QMenu.0a3c81a9.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const na={__name:"CompButtonWorkNo",props:["params"],setup(X){const w=X,{updateSelectedValue:C}=w.params,D=n(w.params.data),q=()=>{C(D)};return(c,H)=>(u(),y("div",null,[t(b,{dense:"",rounded:"",outline:"",color:"secondary",onClick:q,class:"text-bold text-subtitle2 q-px-md"},{default:r(()=>[t(h,{name:"share",size:"xs",class:"q-pt-xs q-mr-sm"}),_(" "+K(D.value.workNo),1)]),_:1})]))}},ia={class:"row"},da={class:"col-xs-12 col-lg-12"},ua=i("span",{class:"text-subtitle1 text-bold"}," \uACF5\uD1B5\uBAA9\uD45C\uC124\uC815 \uC791\uC5C5\uC785\uB2C8\uB2E4.",-1),ca=i("br",null,null,-1),ma=i("br",null,null,-1),pa={key:0,class:"q-ml-xs"},va={key:0,class:"q-ml-xs"},ga={key:0,class:"q-ml-xs"},fa={key:0,class:"q-ml-xs"},ha={class:"row q-col-gutter-x-xl"},wa={class:"col-8"},Da={class:"row q-gutter-md-y-lg"},xa={class:"col-12"},ba={class:"col-12"},ya={class:"row q-gutter-x-lg"},_a={class:"col-4 q-gutter-md-y-xl"},Sa={class:"row q-col-gutter-x-md"},ka={class:"col-6"},Na={class:"col-6 flex flex-center"},Ca=i("div",null,"\uAD8C\uD55C\uC870\uC815 \uAD00\uB9AC",-1),qa={class:"text-bold text-subtitle1"},Va={key:0},Ra=46,al={__name:"MstV1510",setup(X){sa();const w=ra(),C=n(!1),D=n({workNo:""}),q=k({rows:[]}),c=k({rows:[]});n([]);const H=n(300),ee=n(135);Je(()=>q.rows,e=>{const l=e.length*Ra;H.value=ee.value+l},{immediate:!0});const m=oa(),V=n(null),ce=n(0),ae=n(300),me=Te(()=>({height:`${ae.value}px`})),le=n(null),te=n(null),J=n(null),R=n(null),Y=n(null),pe=e=>{R.value=e.api,R.value.setGridOption("headerHeight",45),R.value.setGridOption("rowHeight",45),R.value.deselectAll()},ve=e=>{F=e.api,Y.value=e.api,Y.value.setGridOption("headerHeight",45),Y.value.setGridOption("rowHeight",45),Y.value.deselectAll(),e.api.forEachNode(l=>{l.data.workNo===D.value.workNo&&l.setSelected(!0)})},ge=k({def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1,resizable:!0}}),fe=k({columns:[{headerName:"",field:"",sortable:!1,filter:!1,maxWidth:60,minWidth:60,pinned:"left",cellStyle:{textAlign:"center"},checkboxSelection:!0,headerCheckboxSelection:!0},{headerName:"NO",field:"seq",rowDrag:!0,maxWidth:80,minWidth:80},{headerName:"\uC0AC\uBC88\uC5F0\uACB0",field:"workNo",minWidth:120,maxWidth:120,filter:!0,cellRenderer:na,cellRendererParams:{updateSelectedValue:e=>{console.log("workNo : ",e.value.workNo),D.value.workNo=e.value.workNo,C.value=!0}}},{headerName:"\uACF5\uD1B5\uBAA9\uD45C\uC124\uC815",field:"targetDoc",minWidth:200},{headerName:"\uAC00\uC911\uCE58",field:"weight",maxWidth:100,minWidth:100},{headerName:"\uC0AC\uC6A9\uCC98",field:"useEmpCnt",minWidth:120,maxWidth:120,cellStyle:e=>m.dark.isActive?{color:"cyan",fontWeight:"700"}:{color:"blue",fontWeight:"700"}},{headerName:"\uC0AC\uC6A9",field:"useYn",minWidth:100,maxWidth:100}]}),he=k({def:{flex:1,sortable:!0,filter:!1,floatingFilter:!1,editable:!1}}),we=k({columns:[{headerName:"",field:"",sortable:!1,filter:!1,maxWidth:60,minWidth:60,pinned:"left",cellStyle:{textAlign:"center"},checkboxSelection:!0,headerCheckboxSelection:!0},{headerName:"\uC0AC\uBC88",field:"empCd",maxWidth:100,minWidth:100},{headerName:"\uC131\uBA85",field:"empNm",minWidth:100,maxWidth:100,resizable:!0},{headerName:"\uC18C\uC18D\uD300",field:"deptNm",minWidth:150,maxWidth:150,resizable:!0},{headerName:"\uC9C1\uAE09",field:"titlNm",minWidth:100,resizable:!1}]});Fe(()=>{window.removeEventListener("resize",T)}),Me(()=>{te.value="multiple",le.value="multiple",Ye(),setTimeout(()=>{se()},500)}),Ge(()=>{window.addEventListener("resize",T),T()});const z=n(null),o=n({stdYear:"",workNo:"",seq:0,targetDoc:"",evaS:"",evaA:"",evaB:"",evaC:"",evaD:"",weight:0,deptFg:"",useYn:"N",iuD:""}),De=()=>{o.value.stdYear=w.setYear,o.value.workNo="",o.value.seq=1,o.value.targetDoc="",o.value.evaS="S:100\uC810",o.value.evaA="A:90\uC810",o.value.evaB="B:80\uC810",o.value.evaC="C:70\uC810",o.value.evaD="D:60\uC810",o.value.weight=0,o.value.deptFg="",o.value.useYn="N",o.value.iuD="I"},xe=()=>{R.value.deselectAll(),setTimeout(()=>{De(),z.value=o,V.value="I",g.value=!1,p.value=!1,o.value.stdYear=w.setYear,o.value.deptFg="1",o.value.useYn="Y",setTimeout(()=>{J.value.focus()},100)},100)},be=()=>{z.value=o,V.value="I",p.value=!1,o.value.stdYear=w.setYear,setTimeout(()=>{J.value.focus()},100)},v=n([]),g=n(!0),p=n(!0),ye=e=>{v.value=e.api.getSelectedRows(),g.value=!0,v.value.length===1?(g.value=!1,p.value=!1,ze(v.value[0].stdYear,v.value[0].workNo)):(o.value={},V.value="",p.value=!0)},O=n([]),_e=e=>{O.value=e.api.getSelectedRows()},Se=e=>{},ke=e=>{},Ne=e=>{const l=[];R.value.forEachNode(f=>l.push(f.data));let a=[],d=[];for(let f=0;f<l.length;f++){l[f].seq=f+1;let S='{"mode": "N", "data":'+JSON.stringify(l[f])+"}";a.push(S)}G(I.jsonFiller(a,d))},Ce=e=>{console.log("onRowDragLeave...")},oe=n(0),qe=e=>(oe.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),T=()=>{ae.value=window.innerHeight-oe.value-520},Ve=()=>{let e=[],l=[],a={};for(let d=0;d<c.rows.length;d++){let f=!0;for(let S=0;S<O.value.length;S++)if(c.rows[d].empCd===O.value[S].empCd){if(c.rows[d].iuD!=="U"){a=c.rows[d],a.progId="mst1510",a.workNo=D.value.workNo;let Ie='{"mode": "I", "data":'+JSON.stringify(a)+"}";e.push(Ie),console.log("I : ",c.rows[d].empCd,c.rows[d].empNm)}f=!1}if(f&&c.rows[d].iuD==="U"){a=c.rows[d],a.progId="mst1510",a.workNo=D.value.workNo;let S='{"mode": "D", "data":'+JSON.stringify(a)+"}";l.push(S),console.log("D : ",c.rows[d].empCd,c.rows[d].empNm)}}Oe(I.jsonFiller(e,l))},Re=()=>{ta.exports.isEqual(o.value,z.value)?m.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(console.log("save data::: ",JSON.stringify(o.value)),G(I.dataJsonParse(V.value,o.value)))},We=()=>{m.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],l=[];for(let a=0;a<v.value.length;a++){let d='{"mode":"D","data":'+JSON.stringify(v.value[a])+"}";console.log("delete : ",JSON.stringify(v.value[a])),l.push(d)}G(I.jsonFiller(e,l))}).onCancel(()=>{}).onDismiss(()=>{})};let F=null;const Qe=()=>{B.deptCd="",P(),setTimeout(()=>{F.forEachNode(e=>{e.data.iuD==="U"&&(e.setSelected(!0),console.log("node :: ",e.data.empCd))})},500)},Ae=()=>{console.log("Dialog has closed"),F.value.deselectAll()},M=n(null),B=k({deptCd:""});async function Ye(){try{const e=await W.post("/api/mst/dept_option_list",{paramSetYear:w.setYear});M.value=JSON.parse(JSON.stringify(e.data.data)),M.value.push({deptCd:"",deptNm:"\uC804\uCCB4"})}catch(e){console.error("Error fetching users:",e)}}const se=async()=>{try{const e=await W.post("/api/mst/mst1510_list",{paramSetYear:w.setYear});q.rows=e.data.data,q.rows.length>0&&(ee.value=90)}catch(e){console.error("Error fetching users:",e)}},ze=async(e,l)=>{try{const a=await W.post("/api/mst/mst1510_select",{paramStdYear:e,paramWorkNo:l});o.value=a.data.data[0],z.value=JSON.parse(JSON.stringify(o.value)),V.value="U",p.value=!1}catch(a){console.error("Error fetching users:",a)}},G=e=>{W.post("/api/mst/mst1510_save",e).then(l=>{let a={};a.rtn=l.data.rtn,a.rtnMsg=l.data.rtnMsg,ue.notifyView(a),se()}).catch(l=>{console.log("error: ",l)})},Oe=e=>{W.post("/api/mst/mst1510_tset_save",e).then(l=>{let a={};a.rtn=l.data.rtn,a.rtnMsg=l.data.rtnMsg,ue.notifyView(a),C.value=!1}).catch(l=>{console.log("error: ",l)})},P=async()=>{try{const e=await W.post("/api/mst/mst1510_tset_list",{paramSetYear:w.setYear,paramDeptCd:B.deptCd,paramProgId:"mst1510",paramWorkNo:D.value.workNo});c.rows=e.data.data}catch(e){console.error("Error fetching users:",e)}},re=n(0),Be=()=>{const e=new TextEncoder;re.value=e.encode(o.value.targetDoc).length},Ee={localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}},Ue={getRowStyle:e=>{if(e.node.rowPinned)return{backgroundColor:"lightblue"}},localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}};return(e,l)=>(u(),y(je,null,[t(Pe,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":qe},{default:r(()=>[t(E,{class:"q-pa-sm"},{default:r(()=>[i("div",ia,[i("div",da,[t(He,{rounded:"",class:U(s(m).dark.isActive?"bg-grey-9":"bg-grey-3")},{avatar:r(()=>[t(s(h),{name:"menu_book",color:"primary",size:"md"})]),default:r(()=>[ua,ca,_(" 1. \uC120\uD0DD\uB41C \uBD80\uC11C\uC758 \uBAA8\uB4E0 \uC0AC\uC6D0\uC5D0\uAC8C \uBAA9\uD45C\uC790\uB8CC \uB4F1\uB85D \uC2DC \uC790\uB3D9 \uCD94\uAC00 \uC801\uC6A9\uB429\uB2C8\uB2E4."),ma]),_:1},8,["class"])]),t(A)])]),_:1}),t($,{spaced:""}),t(E,null,{default:r(()=>[t(j,{class:U(["text-center q-pa-sm",s(m).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:r(()=>[t(Ke,{class:"text-h6"},{default:r(()=>[_("\uACF5\uD1B5 \uC5C5\uBB34\uBAA9\uD45C \uC124\uC815\uB4F1\uB85D")]),_:1})]),_:1},8,["class"]),t($,{size:"3px",class:"q-mb-xs"}),t(j,null,{default:r(()=>[t(ie,{class:"row q-pa-none q-gutter-x-xs"},{default:r(()=>[t(A),v.value.length===1?(u(),Q(s(b),{key:0,outline:"",color:"grey",dense:"",onClick:be},{default:r(()=>[t(s(h),{name:"add_to_photos",size:"xs",class:"q-pr-xs"}),s(m).screen.xs?x("",!0):(u(),y("span",pa," \uBCF5\uC0AC "))]),_:1})):x("",!0),t(s(b),{outline:"",color:"grey",dense:"",onClick:xe},{default:r(()=>[t(s(h),{name:"add",size:"xs",class:"q-pr-xs"}),s(m).screen.xs?x("",!0):(u(),y("span",va," \uC2E0\uADDC "))]),_:1}),v.value.length===1||V.value==="I"?(u(),Q(s(b),{key:1,outline:"",color:"blue-12",dense:"",onClick:Re},{default:r(()=>[t(s(h),{name:"save",size:"xs",class:"q-pr-xs"}),s(m).screen.xs?x("",!0):(u(),y("span",ga,"\uC800\uC7A5"))]),_:1})):x("",!0),v.value.length>0?(u(),Q(s(b),{key:2,outline:"",color:"red",dense:"",onClick:We,class:"q-pr-md"},{default:r(()=>[t(Xe,{color:"orange",floating:""},{default:r(()=>[_(K(v.value.length),1)]),_:1}),t(s(h),{name:"delete",size:"xs",class:"q-pr-xs"}),_(),s(m).screen.xs?x("",!0):(u(),y("span",fa," \uC0AD\uC81C "))]),_:1})):x("",!0)]),_:1}),(u(),y("div",{key:ce.value,style:ne({height:H.value+"px"})},[t(s(de),{style:{width:"100%",height:"100%"},class:U(s(m).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:fe.columns,rowData:q.rows,defaultColDef:ge.def,rowSelection:te.value,onSelectionChanged:ye,onGridReady:pe,"grid-options":Ue,rowDragManaged:!0,animateRows:!0,onRowDragMove:Se,onRowDragEnd:Ne,onRowDragEnter:ke,onRowDragLeave:Ce},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)),t($,{spaced:""}),t(E,{class:"q-pa-lg"},{default:r(()=>[i("div",ha,[i("div",wa,[i("div",Da,[i("div",xa,[t(N,{ref_key:"focusStart",ref:J,readonly:g.value,disable:p.value,modelValue:o.value.targetDoc,"onUpdate:modelValue":[l[0]||(l[0]=a=>o.value.targetDoc=a),Be],clearable:"",type:"textarea",color:"orange-13","label-color":"orange-13",label:"\uACF5\uD1B5\uBAA9\uD45C\uC124\uC815",rows:"3",hint:`${re.value} / 100\uC790 \uAE4C\uC9C0 \uC785\uB825\uD558\uC2E4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`},null,8,["readonly","disable","modelValue","hint"])]),i("div",ba,[i("div",ya,[t(N,{readonly:g.value,disable:p.value,modelValue:o.value.evaS,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.evaS=a),dense:"",clearable:"",color:"purple-12","label-color":"purple-12",label:"\uD3C9\uAC00\uAE30\uC900(S)",hint:"\uD3C9\uAC00\uAE30\uC900 S(100)\uC5D0 \uD574\uB2F9\uB418\uB294 \uAE30\uC900"},null,8,["readonly","disable","modelValue"]),t(N,{readonly:g.value,disable:p.value,modelValue:o.value.evaA,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.evaA=a),dense:"",clearable:"",color:"purple-12","label-color":"purple-12",label:"\uD3C9\uAC00\uAE30\uC900(A)",hint:"\uD3C9\uAC00\uAE30\uC900 A(90)\uC5D0 \uD574\uB2F9\uB418\uB294 \uAE30\uC900"},null,8,["readonly","disable","modelValue"]),t(N,{readonly:g.value,disable:p.value,modelValue:o.value.evaB,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.evaB=a),dense:"",clearable:"",color:"purple-12","label-color":"purple-12",label:"\uD3C9\uAC00\uAE30\uC900(B)",hint:"\uD3C9\uAC00\uAE30\uC900 B(80)\uC5D0 \uD574\uB2F9\uB418\uB294 \uAE30\uC900"},null,8,["readonly","disable","modelValue"]),t(N,{readonly:g.value,disable:p.value,modelValue:o.value.evaC,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.evaC=a),dense:"",clearable:"",color:"purple-12","label-color":"purple-12",label:"\uD3C9\uAC00\uAE30\uC900(C)",hint:"\uD3C9\uAC00\uAE30\uC900 C(70)\uC5D0 \uD574\uB2F9\uB418\uB294 \uAE30\uC900"},null,8,["readonly","disable","modelValue"]),t(N,{readonly:g.value,disable:p.value,modelValue:o.value.evaD,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.evaD=a),dense:"",clearable:"",color:"purple-12","label-color":"purple-12",label:"\uD3C9\uAC00\uAE30\uC900(D)",hint:"\uD3C9\uAC00\uAE30\uC900 D(60)\uC5D0 \uD574\uB2F9\uB418\uB294 \uAE30\uC900"},null,8,["readonly","disable","modelValue"])])])])]),i("div",_a,[i("div",Sa,[i("div",ka,[t(N,{readonly:g.value,disable:p.value,modelValue:o.value.weight,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.weight=a),type:"number",color:"pink-12","label-color":"pink-12",label:"\uAC00\uC911\uCE58",hint:"\uAC00\uC911\uCE58\uB97C \uC124\uC815\uD558\uC138\uC694",rules:[a=>parseInt(a)<=100||"\uAC00\uC911\uCE58\uD569\uC774 100\uC774 \uB118\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."]},null,8,["readonly","disable","modelValue","rules"])]),i("div",Na,[t(s(Le),{size:"lg",modelValue:o.value.useYn,"onUpdate:modelValue":l[7]||(l[7]=a=>o.value.useYn=a),"true-value":"Y","false-value":"N","checked-icon":"check","unchecked-icon":"clear",color:"primary",label:"\uC0AC\uC6A9"},null,8,["modelValue"])])])])])]),_:1})]),_:1})]),_:1})]),_:1}),t($e,{persistent:"",modelValue:C.value,"onUpdate:modelValue":l[10]||(l[10]=a=>C.value=a),onShow:Qe,onHide:Ae},{default:r(()=>[t(E,{flat:"",bordered:"",style:{"max-width":"520px",width:"100%"}},{default:r(()=>[t(aa,null,{default:r(()=>[t(s(h),{name:"list_alt"}),Ca,t(A),i("span",qa," \uACF5\uD1B5\uAD00\uB9AC\uBC88\uD638 [ "+K(D.value.workNo)+" ] ",1),t(A),L((u(),Q(s(b),{dense:"",flat:"",icon:"close"},{default:r(()=>[t(ea,null,{default:r(()=>[_(" \uB2EB\uAE30 ")]),_:1})]),_:1})),[[Z]])]),_:1}),t(Ze,null,{default:r(()=>[t(ie,{class:"q-px-sm q-py-none"},{default:r(()=>[t(la,{dense:"","stack-label":"","options-dense":"",class:"q-pb-sm q-mr-lg","label-color":"orange",modelValue:B.deptCd,"onUpdate:modelValue":[l[8]||(l[8]=a=>B.deptCd=a),P],options:M.value,"option-value":"deptCd","option-label":"deptNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"130px","max-width":"130px"},label:"\uC18C\uC18D\uD300"},null,8,["modelValue","options"]),t(s(b),{dense:"",outline:"",class:"q-px-md",color:"teal","on:click":l[9]||(l[9]=a=>P())},{default:r(()=>[t(s(h),{name:"refresh",size:"xs",class:"q-pr-sm-sm"}),s(m).screen.gt.sm?(u(),y("span",Va,"\uB2E4\uC2DC\uBD88\uB7EC\uC624\uAE30")):x("",!0)]),_:1}),t(A),O.value.length>0?L((u(),Q(s(b),{key:0,outline:"",dense:"",color:"primary",onClick:Ve,class:"q-px-sm q-mr-sm"},{default:r(()=>[t(s(h),{class:"q-mr-xs",name:"save",size:"xs"}),_(" \uC800\uC7A5\uD558\uAE30 ")]),_:1})),[[Z]]):x("",!0),L((u(),Q(s(b),{outline:"",dense:"",color:"primary",class:"q-px-sm"},{default:r(()=>[t(s(h),{class:"q-mr-xs",name:"close",size:"xs"}),_(" \uB2EB\uAE30 ")]),_:1})),[[Z]])]),_:1})]),_:1}),t(j,{class:"q-px-md q-pt-none"},{default:r(()=>[i("div",{style:ne(me.value)},[t(s(de),{style:{width:"100%",height:"100%"},class:U(s(m).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:we.columns,rowData:c.rows,defaultColDef:he.def,rowSelection:le.value,onSelectionChanged:_e,suppressRowClickSelection:!0,onGridReady:ve,"grid-options":Ee},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{al as default};
