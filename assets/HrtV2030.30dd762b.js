import{Q as ee}from"./QItemLabel.4a9918b4.js";import{R as te,ad as I,r as h,U as R,V as B,W as l,n as a,aa as S,Y as s,a5 as b,a2 as V,Z as x,ab as ae,X as U,bu as G,$ as o,a0 as m,a8 as L,F as oe,ag as le,a7 as Z,b8 as ne,b9 as se,j as re,p as ie,k as de,o as ce,S as H,a6 as pe,a9 as ue,bE as me,af as he}from"./index.7f77393b.js";import{Q as $}from"./QSelect.114f76c2.js";import{Q as T}from"./QSpace.d904af94.js";import{Q as ge}from"./QToolbar.963c8e72.js";/* empty css                        */import{A as fe}from"./main.esm.3000f5c9.js";import"./SessionStorage.b85a400f.js";import{u as j}from"./use-quasar.49a49e75.js";import{u as J}from"./setYearInfo.8b7f3a45.js";import{Q as ve}from"./QTooltip.472888d5.js";import{Q as we}from"./QBar.aa6ab1e6.js";import{p as _e}from"./print.22a271a6.js";import{u as D,w as be}from"./xlsx.db07aefa.js";import"./QField.5fb0fda7.js";import"./QItemSection.f93cdc59.js";import"./QMenu.0a3c81a9.js";import"./position-engine.150cbc63.js";import"./selection.004dbe93.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const A=C=>(ne("data-v-4429ffd2"),C=C(),se(),C),xe=A(()=>o("span",{class:"text-subtitle1 q-ml-sm"},"\uCD9C\uB825\uBB3C\uAD00\uB9AC\uD654\uBA74",-1)),Ce=A(()=>o("span",{class:"text-bold text-subtitle1"},null,-1)),ye={id:"printZone"},ke={class:"row q-px-xs"},Se=A(()=>o("span",{class:"text-h6"},"\uC5ED\uB7C9\uD3C9\uAC00 \uC9D1\uACC4\uD45C \uD604\uD669",-1)),Ve={class:"text-h6"},qe=A(()=>o("tr",null,[o("th",{rowspan:"1",colspan:"2"},"\uC18C\uC18D"),o("th",{rowspan:"2",colspan:"1"},"\uC131\uBA85"),o("th",{rowspan:"1",colspan:"2"},"1\uCC28\uD3C9\uAC00"),o("th",{rowspan:"1",colspan:"2"},"2\uCC28\uD3C9\uAC00"),o("th",{rowspan:"2",colspan:"1"},"\uD569\uC0B0\uC810\uC218")],-1)),Ne=A(()=>o("tr",null,[o("th",null,"\uC18C\uC18D"),o("th",null,"\uC9C1\uAE09"),o("th",null,"\uD658\uC0B0\uC810\uC218"),o("th",null,"\uD658\uC0B0\uC810\uC218(70%)"),o("th",null,"\uD658\uC0B0\uC810\uC218"),o("th",null,"\uD658\uC0B0\uC810\uC218(30%)")],-1)),Pe={__name:"HrtV2030p",props:{rowData:Array},emits:["close"],setup(C,{emit:y}){const g=J(),c=j(),w=y,E=C;function q(){console.log("closeDialog called"),w("close")}const Y=()=>{_e({printable:"printZone",type:"html",css:["/src/css/print/hrt2030.css"],scanStyles:!1})};window.matchMedia("(prefers-color-scheme: dark)").matches?console.log("Dark mode is enabled"):console.log("Light mode is enabled");const N=()=>{c.dialog({dark:!0,title:"Excel \uC800\uC7A5",html:!0,message:"\uC5D1\uC140 \uD30C\uC77C\uB85C \uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",ok:{label:"\uC800\uC7A5",color:"primary"},cancel:{label:"\uB2EB\uAE30",color:"secondary"}}).onOk(()=>{X()}).onCancel(()=>{}).onDismiss(()=>{})},t=I({header:[],headProps:["deptNm","titlNm","empNm","itemFgNm","itemNm","weight","ch1MarkPoint","ch1MarkPointX","ch2MarkPoint","ch2MarkPointX"],headRow1:[{name:"\uC18C\uC18D\uD300",rowspan:1,colspan:2},{name:"\uC131\uBA85",rowspan:2,colspan:1,key:"empNm"},{name:"1\uCC28\uD3C9\uAC00",rowspan:1,colspan:2},{name:"2\uCC28\uD3C9\uAC00",rowspan:1,colspan:2},{name:"\uD569\uC0B0\uC810\uC218",rowspan:2,colspan:1,key:"avgMarkPointX"}],headRow2:[{name:"\uC18C\uC18D",rowspan:1,colspan:1,key:"deptNm"},{name:"\uC9C1\uAE09",rowspan:1,colspan:1,key:"titlNm"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"ch1MarkPointX"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"ch1MarkPointAvg"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"ch2MarkPointX"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"ch2MarkPointAvg"}]}),X=()=>{t.header=[],t.header.push(t.headRow1),t.header.push(t.headRow2);let _={header:t.header,headProps:t.headProps};M(E.rowData,_)},d=h([]),k=h(void 0),M=(_,f)=>{let r=[];if(Array.isArray(f.headProps))r=f.headProps;else if(f.headProps==="header")for(let p of t.header)r.push(p.key);else r=Object.keys(_[0]);d.value=t.headProps,k.value=document.createElement("table");let P=[];Array.isArray(t.header[0])?P=t.header:P.push(t.header);let Q=document.createElement("thead");for(let p of P){let u=document.createElement("tr");for(let v of p){let F=v.rowspan||"1",K=v.colspan||"1",O=document.createElement("th");O.setAttribute("rowspan",F),O.setAttribute("colspan",K),O.innerText=v.name,u.appendChild(O)}Q.appendChild(u)}k.value.appendChild(Q);let z=document.createElement("tbody");for(let p of _){let u=document.createElement("tr");for(let v of d.value){let F=document.createElement("td");F.innerText=p[v],u.appendChild(F)}z.appendChild(u)}k.value.appendChild(z);const W={raw:!0,type:"string"},e=D.table_to_sheet(k.value,W);e.A1.s={font:{color:{rgb:"FF0000"},bold:!0}};const n=D.decode_range(e["!ref"]);for(let p=n.s.r;p<=n.e.r;++p)for(let u=n.s.c;u<=n.e.c;++u){const v=D.encode_cell({r:p,c:u});!e[v]||(e[v].s={border:{top:{style:"thin",color:{rgb:"0000FF"}},bottom:{style:"thin",color:{rgb:"0000FF"}},left:{style:"thin",color:{rgb:"0000FF"}},right:{style:"thin",color:{rgb:"0000FF"}}}})}let i=D.book_new();D.book_append_sheet(i,e,"\uC5ED\uB7C9\uD3C9\uAC00\uC885\uD569\uC9D1\uACC4\uD45C"),be(i,"\uC5ED\uB7C9\uD3C9\uAC00\uC885\uD569\uC9D1\uACC4\uD45C.xlsx")};return(_,f)=>(R(),B(Z,null,{default:l(()=>[a(S,{flat:"",bordered:""},{default:l(()=>[a(we,null,{default:l(()=>[a(s(b),{name:"print"}),xe,a(T),Ce,a(T),a(s(V),{dense:"",flat:"",icon:"close",onClick:q},{default:l(()=>[a(ve,null,{default:l(()=>[x(" \uB2EB\uAE30 ")]),_:1})]),_:1})]),_:1}),a(S,null,{default:l(()=>[a(ae,{align:"right",class:U(s(c).dark.isActive?"bg-grey-8 text-teal":"bg-blue-grey-1 text-teal")},{default:l(()=>[a(s(V),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:N},{default:l(()=>[a(s(b),{class:"q-mr-xs",name:"download",size:"xs"}),x(" \uC5D1\uC140 ")]),_:1},8,["color"]),a(s(V),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:Y},{default:l(()=>[a(s(b),{class:"q-mr-xs",name:"print",size:"xs"}),x(" \uCD9C\uB825 ")]),_:1},8,["color"]),a(s(V),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:q},{default:l(()=>[a(s(b),{class:"q-mr-xs",name:"close",size:"xs"}),x(" \uB2EB\uAE30 ")]),_:1},8,["color"])]),_:1},8,["class"]),a(G,{class:"q-pt-none"},{default:l(()=>[o("div",ye,[o("div",ke,[Se,a(T),o("span",Ve,"\uAE30\uC900\uB144\uB3C4 : "+m(s(g).setYear)+"\uB144",1)]),o("table",null,[qe,Ne,(R(!0),L(oe,null,le(E.rowData,r=>(R(),L("tr",{key:r.empCd},[o("td",null,m(r.deptNm),1),o("td",null,m(r.titlNm),1),o("td",null,m(r.empNm),1),o("td",null,m(r.ch1MarkPointX),1),o("td",null,m(r.ch1MarkPointAvg),1),o("td",null,m(r.ch2MarkPointX),1),o("td",null,m(r.ch2MarkPointAvg),1),o("td",null,m(r.avgMarkPointX),1)]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1}))}};var De=te(Pe,[["__scopeId","data-v-4429ffd2"]]);const Re={class:""},Ae={class:"col-xs-12 col-sm-9 row"},Ee={class:"row q-gutter-x-xs"},Me=45,at={__name:"HrtV2030",setup(C){const y=J(),g=I({rows:[]}),c=h(!1),w=h(145),E=h(90),q=j();function Y(){console.log("handleClose called"),c.value=!1}const N=h(300);re(()=>({height:`${N.value}px`}));const t=h({textValue:"",deptCd:null,titlCd:null,catgCd:null,deptOptions:null,titlOptions:null,catgOptions:null}),X=I({group:[{headerName:"#",minWidth:70,maxWidth:80,pinned:"left",sortable:!1,filter:!1,valueGetter:function(e){return e.node.rowIndex+1},cellStyle:e=>({textAlign:"center"})},{headerName:"\uC18C\uC18D",field:"deptNm",minWidth:105,cellStyle:e=>d(e.data)},{headerName:"\uC9C1\uAE09",field:"titlNm",minWidth:90,cellStyle:e=>d(e.data)},{headerName:"\uC131\uBA85",field:"empNm",minWidth:90,resizable:!0,cellStyle:e=>d(e.data)},{headerName:"1\uCC28\uD658\uC0B0\uC810\uC218",field:"ch1MarkPointX",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"1\uCC28\uC810\uC218(70%)",field:"ch1MarkPointAvg",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"2\uCC28\uD658\uC0B0\uC810\uC218",field:"ch2MarkPointX",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"2\uCC28\uC810\uC218(30%)",field:"ch2MarkPointAvg",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uD569\uC0B0\uC810\uC218",field:"avgMarkPointX",minWidth:100,cellStyle:e=>d(e.data)}]}),d=e=>({color:"dark"});ie(()=>{window.removeEventListener("resize",f)}),de(()=>{P(),Q(),z()}),ce(()=>{window.addEventListener("resize",f),f()});const k=h([]),M=h(0),_=e=>(M.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),f=()=>{N.value=window.innerHeight-M.value},r=async()=>{try{const e=await H.post("/api/hrt/hrt2030_list",{paramSetYear:y.setYear,paramDeptCd:t.value.deptCd,paramTitlCd:t.value.titlCd,paramCatgCd:t.value.catgCd,paramSearchValue:t.value.textValue});if(g.rows=e.data.data,g.rows.length===0)w.value=145;else{w.value=E.value+g.rows.length*Me;const n=N.value-180;w.value>n&&(w.value=n)}}catch(e){console.error("Error fetching users:",e)}};async function P(){try{const e=await H.post("/api/mst/dept_option_list",{paramSetYear:y.setYear});t.value.deptOptions=e.data.data,t.value.deptOptions.unshift({deptCd:"",deptNm:"\uC804\uCCB4"}),t.value.deptCd=""}catch(e){console.error("Error fetching users:",e)}}async function Q(){try{const e=await H.post("/api/mst/titl_option_list",{paramSetYear:y.setYear});t.value.titlOptions=e.data.data,t.value.titlOptions.unshift({titlCd:"",titlNm:"\uC804\uCCB4"}),t.value.titlCd=""}catch(e){console.error("Error fetching users:",e)}}async function z(){try{const e=await H.post("/api/mst/catg_option_list",{paramSetYear:y.setYear});t.value.catgOptions=e.data.data,t.value.catgOptions.unshift({catgCd:"",catgNm:"\uC804\uCCB4"}),t.value.catgCd=""}catch(e){console.error("Error fetching users:",e)}}const W={columnDefs:X.group,defaultColDef:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1},rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,enableRangeSelection:!0,suppressRowClickSelection:!1,animateRows:!0,suppressHorizontalScroll:!0,localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."},getRowStyle:function(e){return e.node.rowPinned?{"font-weight":"bold",background:"#dddddd"}:{"text-align":"left"}},getRowHeight:function(e){return e.node.rowPinned?45:25},onGridReady:function(e){e.api.sizeColumnsToFit()},onGridSizeChanged:function(e){e.api.sizeColumnsToFit()},onRowEditingStarted:function(e){console.log("never called - not doing row editing")},onRowEditingStopped:function(e){console.log("never called - not doing row editing")},onCellEditingStarted:function(e){console.log("cellEditingStarted")},onCellEditingStopped:function(e){console.log("cellEditingStopped")},onRowClicked:function(e){console.log("onRowClicked"),k.value=e.api.getSelectedRows()},onCellClicked:function(e){console.log("onCellClicked")},isRowSelectable:function(e){return!0},onSelectionChanged:function(e){console.log("onSelectionChanged")},onSortChanged:function(e){console.log("onSortChanged")},onCellValueChanged:function(e){console.log("onCellValueChanged")},getRowNodeId:function(e){return null},setPinnedTopRowData:function(e){return null},setPinnedBottomRowData:function(e){return null},debug:!1};return(e,n)=>(R(),B(Z,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":_},{default:l(()=>[a(S,{class:"q-pa-sm"},{default:l(()=>[a(G,{class:U(["text-center q-pa-sm q-mb-sm",s(q).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:l(()=>[a(ee,{class:"text-h6"},{default:l(()=>[x("\uC5ED\uB7C9\uD3C9\uAC00 \uD604\uD669 ")]),_:1})]),_:1},8,["class"]),o("div",Re,[a(S,{class:"q-pa-sm"},{default:l(()=>[a(ge,{class:"row q-px-none q-pt-none"},{default:l(()=>[o("div",Ae,[a($,{"stack-label":"","options-dense":"",class:"q-px-md q-mr-xs","label-color":"orange",modelValue:t.value.deptCd,"onUpdate:modelValue":[n[0]||(n[0]=i=>t.value.deptCd=i),r],options:t.value.deptOptions,"option-value":"deptCd","option-label":"deptNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC18C\uC18D\uD300"},null,8,["modelValue","options"]),a($,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.titlCd,"onUpdate:modelValue":[n[1]||(n[1]=i=>t.value.titlCd=i),r],options:t.value.titlOptions,"option-value":"titlCd","option-label":"titlNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"90px"},label:"\uC9C1\uAE09"},null,8,["modelValue","options"]),a($,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.catgCd,"onUpdate:modelValue":[n[2]||(n[2]=i=>t.value.catgCd=i),r],options:t.value.catgOptions,"option-value":"catgCd","option-label":"catgNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC9C1\uBD84\uB958"},null,8,["modelValue","options"]),a(pe,{"stack-label":"","label-color":"orange","bottom-slots":"",modelValue:t.value.textValue,"onUpdate:modelValue":[n[4]||(n[4]=i=>t.value.textValue=i),r],label:"\uAC80\uC0C9(\uC131\uBA85)",class:"q-pb-none",style:{width:"110px"}},{append:l(()=>[t.value.textValue!==""?(R(),B(s(b),{key:0,name:"close",onClick:n[3]||(n[3]=i=>t.value.textValue=""),size:"xs",class:"cursor-pointer q-pt-md"})):ue("",!0)]),_:1},8,["modelValue"])]),a(T),o("div",Ee,[a(s(V),{outline:"",color:"grey",onClick:r,class:"q-px-sm"},{default:l(()=>[a(s(b),{name:"search",size:"xs",class:"q-mr-xs"}),x(" \uC870\uD68C ")]),_:1}),a(s(V),{disable:g.rows.length===0,outline:"",color:"teal",onClick:n[5]||(n[5]=i=>c.value=!0),class:"q-px-sm"},{default:l(()=>[a(s(b),{name:"download",size:"xs",class:"q-mr-xs"}),x(" \uC5D1\uC140/\uCD9C\uB825 ")]),_:1},8,["disable"])])]),_:1}),a(S,{class:"q-mt-sm"},{default:l(()=>[o("div",{style:me({height:w.value+"px"})},[a(s(fe),{style:{width:"100%",height:"100%"},class:U(s(q).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),rowData:g.rows,"grid-options":W},null,8,["class","rowData"])],4)]),_:1})]),_:1})])]),_:1}),a(he,{persistent:"","full-height":"","full-width":"",modelValue:c.value,"onUpdate:modelValue":n[6]||(n[6]=i=>c.value=i)},{default:l(()=>[a(S,{class:"q-pa-none q-ma-none"},{default:l(()=>[a(G,{class:"q-pa-none q-ma-none"},{default:l(()=>[a(De,{rowData:g.rows,onClose:Y},null,8,["rowData"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{at as default};
