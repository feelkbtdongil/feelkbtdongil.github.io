import{Q as ke}from"./QBanner.bf865535.js";import{Q as H}from"./QSpace.ddaf28ca.js";import{ad as Q,r as s,w as Ce,j as Ne,p as qe,k as Re,o as Qe,S as O,U as c,V as D,W as r,a7 as Oe,n as l,$ as i,X as z,Y as n,a5 as x,Z as b,aa as I,a1 as Y,bu as T,a2 as k,bE as ae,a8 as C,a9 as p,a0 as ze,a6 as te}from"./index.07fc3cde.js";import{Q as Ve}from"./QItemLabel.848dda36.js";import{Q as le}from"./QToolbar.e70c6bf5.js";import{Q as Ae}from"./QBadge.76c358a2.js";import{Q as Ee}from"./QSelect.3c86eb28.js";/* empty css                        */import{A as oe}from"./main.esm.15e3c1e8.js";import{l as We}from"./lodash.de417675.js";import{j as B,n as Ge}from"./json-util.73e249df.js";import{u as He}from"./use-quasar.9559018b.js";import{u as Ie}from"./setUserInfo.4ca40c19.js";import{u as Ye}from"./setYearInfo.f0ebbaa1.js";import"./QField.2ae85778.js";import"./QItemSection.345ae796.js";import"./QMenu.8bcf41ca.js";import"./position-engine.7c438a6d.js";import"./selection.ae892694.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const Te={class:"row"},Be={class:"col-xs-12 col-lg-12"},Fe=i("span",{class:"text-subtitle1 text-bold"}," \uC5ED\uB7C9\uD3C9\uAC00 \uAE30\uC900 \uD56D\uBAA9\uC815\uC758 \uC124\uC815 \uC791\uC5C5\uC785\uB2C8\uB2E4.",-1),Je=i("br",null,null,-1),Me=i("br",null,null,-1),Ue=i("br",null,null,-1),Le={class:"row"},je={class:"col-xs-2"},$e={class:"q-gutter-xs"},Pe={class:"col-xs-10"},Ze={key:0,class:"q-ml-xs"},Ke={key:0,class:"q-ml-xs"},Xe={key:0,class:"q-ml-xs"},ea={key:0,class:"q-ml-xs"},aa={class:"row q-col-gutter-x-xl"},ta={class:"col-2"},la={class:"col-8"},oa={class:"col-2"},sa=46,qa={__name:"MstV1520",setup(na){Ie();const N=Ye(),g=Q({rows:[],rowsSel:[]}),V=s(300),F=s(135);Ce(()=>g.rows,e=>{const a=e.length*sa;V.value=F.value+a},{immediate:!0});const d=He(),y=s(null),J=s(0),M=s(300);Ne(()=>({height:`${M.value}px`}));const U=s(null),L=s(null),A=s(null),q=s(null),h=s(null),se=e=>{q.value=e.api,q.value.setGridOption("headerHeight",45),q.value.setGridOption("rowHeight",45),q.value.deselectAll()},ne=e=>{h.value=e.api,h.value.setGridOption("headerHeight",45),h.value.setGridOption("rowHeight",45),re(),h.value.deselectAll()},j=Q({defSel:{flex:1,sortable:!0,filter:!1,floatingFilter:!1,editable:!1},def:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1}}),$=Q({sel:[{headerName:"#",width:60,pinned:"left",valueGetter:function(e){return e.node.rowIndex+1}},{headerName:"\uBD84\uB958\uD56D\uBAA9",field:"commNm",sortable:!0,filter:!1,cellStyle:{textAlign:"center"}}],columns:[{headerName:"",field:"",sortable:!1,filter:!1,maxWidth:60,minWidth:60,pinned:"left",cellStyle:{textAlign:"center"},checkboxSelection:!0,headerCheckboxSelection:!0},{headerName:"No",field:"seq",rowDrag:!0,maxWidth:80,minWidth:80},{headerName:"\uD3C9\uAC00\uBD84\uB958",field:"divNm",minWidth:150,maxWidth:150,resizable:!0},{headerName:"\uD3C9\uAC00\uD56D\uBAA9\uBA85",field:"itemNm",minWidth:200,resizable:!0},{headerName:"\uAC00\uC911\uCE58",field:"weight",maxWidth:95,minWidth:95,resizable:!1,cellStyle:e=>d.dark.isActive?{color:"cyan",fontWeight:"700"}:{color:"blue",fontWeight:"700"}}]}),m=s(0),re=()=>{m.value=0,g.rows.forEach(a=>{m.value+=a.weight});const e=[{itemNm:"\uD569\uACC4",weight:m.value}];h.value.updateGridOptions({pinnedBottomRowData:e})};Q({evsGroup:{empCd:"",empNm:"",deptCd:"",deptNm:"",titlCd:"",titlNm:""},evtGroup:{empCd:"",empNm:"",deptCd:"",deptNm:"",titlCd:"",titlNm:""}}),qe(()=>{window.removeEventListener("resize",E)}),Re(()=>{L.value="single",U.value="multiple",K("202"),setTimeout(()=>{K("203")},500)}),Qe(()=>{window.addEventListener("resize",E),E()});const R=s(null),t=s({stdYear:"",itemFg:"",workNo:"",divCd:"",itemNm:"",seq:0,weight:0,iuD:""}),ie=()=>{t.value.stdYear=N.setYear,t.value.itemFg=f.value[0].commCd,t.value.workNo="",t.value.divCd="",t.value.itemNm="",t.value.seq=1,t.value.weight=0,t.value.iuD="I"},ue=()=>{h.value.deselectAll(),setTimeout(()=>{ie(),R.value=t,t.value.weight=100-m.value,t.value.status="0",y.value="I",S.value=!1,v.value=!1,t.value.stdYear=N.setYear,t.value.itemFg=f.value[0].commCd,setTimeout(()=>{A.value.focus()},100)},100)},de=()=>{R.value=t,t.value.weight=100-m.value,y.value="I",v.value=!1,t.value.stdYear=N.setYear,setTimeout(()=>{A.value.focus()},100)},f=s([]),u=s([]),S=s(!0),v=s(!0),ce=e=>{f.value=e.api.getSelectedRows(),console.log("aaa : ",JSON.stringify(f.value)),f.value.length>0&&W(f.value[0].commCd)},me=e=>{u.value=e.api.getSelectedRows(),S.value=!0,u.value.length===1?(S.value=!1,v.value=!1,ye(u.value[0].stdYear,u.value[0].itemFg,u.value[0].workNo)):(t.value={},y.value="",v.value=!0)},ve=e=>{},pe=e=>{},ge=e=>{const a=[];h.value.forEachNode(_=>a.push(_.data));let o=[],w=[];for(let _=0;_<a.length;_++){a[_].seq=_+1;let De='{"mode": "N", "data":'+JSON.stringify(a[_])+"}";o.push(De)}G(B.jsonFiller(o,w))},he=e=>{console.log("onRowDragLeave...")},P=s(0),fe=e=>(P.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),E=()=>{M.value=window.innerHeight-P.value-520},we=()=>{We.exports.isEqual(t.value,R.value)?d.dialog({dark:!0,title:"\uC548\uB0B4",message:"\uBCC0\uACBD\uB41C \uC790\uB8CC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{}):(console.log("save data::: ",JSON.stringify(t.value)),G(B.dataJsonParse(y.value,t.value)))},_e=()=>{d.dialog({dark:!0,title:"\uC790\uB8CC\uC0AD\uC81C",message:"\uC120\uD0DD\uB41C \uC790\uB8CC\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? ",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"grey-7"}}).onOk(()=>{let e=[],a=[];for(let o=0;o<u.value.length;o++){let w='{"mode":"D","data":'+JSON.stringify(u.value[o])+"}";console.log("delete : ",JSON.stringify(u.value[o])),a.push(w)}G(B.jsonFiller(e,a))}).onCancel(()=>{}).onDismiss(()=>{})},Z=s([]);s(null);const K=async e=>{try{const a=await O.post("/api/mst/comm_option_list",{paramCommCd1:e});switch(e){case"202":g.rowsSel=a.data.data;break;case"203":Z.value=a.data.data;break;default:break}console.log("getData1: ",JSON.stringify(a.data.data))}catch(a){console.error("Error fetching users:",a)}},W=async e=>{try{const a=await O.post("/api/mst/mst1520_list",{paramSetYear:N.setYear,paramItemFg:e});g.rows=a.data.data,g.rows.length>0&&(F.value=90),J.value+=1}catch(a){console.error("Error fetching users:",a)}},X=s(0),ye=async(e,a,o)=>{console.log("aa ::: ",e,a,o);try{const w=await O.post("/api/mst/mst1520_select",{paramStdYear:e,paramItemFg:a,paramWorkNo:o});t.value=w.data.data[0],R.value=JSON.parse(JSON.stringify(t.value)),X.value=t.value.weight,y.value="U",v.value=!1}catch(w){console.error("Error fetching users:",w)}},G=e=>{O.post("/api/mst/mst1520_save",e).then(a=>{let o={};o.rtn=a.data.rtn,o.rtnMsg=a.data.rtnMsg,Ge.notifyView(o),W(f.value[0].commCd)}).catch(a=>{console.log("error: ",a)})},ee=s(0),Se=()=>{const e=new TextEncoder;ee.value=e.encode(t.value.targetDoc).length},xe={localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}},be={getRowStyle:e=>{if(e.node.rowPinned)return{backgroundColor:"lightblue"}},localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."}};return(e,a)=>(c(),D(Oe,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":fe},{default:r(()=>[l(I,{class:"q-pa-sm"},{default:r(()=>[i("div",Te,[i("div",Be,[l(ke,{rounded:"",class:z(n(d).dark.isActive?"bg-grey-9":"bg-grey-3")},{avatar:r(()=>[l(n(x),{name:"menu_book",color:"primary",size:"md"})]),default:r(()=>[Fe,Je,b(" 1. \uBA3C\uC800 \uD3C9\uAC00\uB300\uC0C1\uD56D\uBAA9\uC744 \uC120\uD0DD\uD558\uACE0 \uAC01 \uD56D\uBAA9\uBA85\uC744 \uB4F1\uB85D\uD558\uC2ED\uC2DC\uC694."),Me,b(" 2. \uAC00\uC911\uCE58\uB294 \uD569\uC774 100\uC744 \uB118\uC5B4\uC124\uC218\uB294 \uC5C6\uC2B5\uB2C8\uB2E4."),Ue]),_:1},8,["class"])]),l(H)])]),_:1}),l(Y,{spaced:""}),l(I,null,{default:r(()=>[l(T,{class:z(["text-center q-pa-sm",n(d).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:r(()=>[l(Ve,{class:"text-h6"},{default:r(()=>[b("\uC5ED\uB7C9\uD3C9\uAC00 \uAE30\uC900 \uD56D\uBAA9\uC815\uC758")]),_:1})]),_:1},8,["class"]),l(Y,{size:"3px",class:"q-mb-xs"}),i("div",Le,[i("div",je,[l(T,null,{default:r(()=>[l(le,{class:"row q-pa-none"},{default:r(()=>[i("div",$e,[l(n(k),{outline:"",color:"grey",dense:"",onClick:W},{default:r(()=>[l(n(x),{name:"refresh",size:"xs",class:"q-mr-xs"}),b(" \uB2E4\uC2DC \uBD88\uB7EC\uC624\uAE30 ")]),_:1})]),l(H)]),_:1}),i("div",{style:ae({height:V.value+"px"})},[l(n(oe),{style:{width:"100%",height:"100%"},class:z(n(d).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:$.sel,rowData:g.rowsSel,defaultColDef:j.defSel,rowSelection:L.value,onSelectionChanged:ce,onGridReady:se,"grid-options":xe},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)]),_:1})]),i("div",Pe,[l(T,null,{default:r(()=>[l(le,{class:"row q-pa-none q-gutter-x-xs"},{default:r(()=>[l(H),m.value<100&&u.value.length===1?(c(),D(n(k),{key:0,outline:"",color:"grey",dense:"",onClick:de},{default:r(()=>[l(n(x),{name:"add_to_photos",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),C("span",Ze," \uBCF5\uC0AC "))]),_:1})):p("",!0),m.value<100?(c(),D(n(k),{key:1,outline:"",color:"grey",dense:"",onClick:ue},{default:r(()=>[l(n(x),{name:"add",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),C("span",Ke," \uC2E0\uADDC "))]),_:1})):p("",!0),u.value.length===1||y.value==="I"?(c(),D(n(k),{key:2,outline:"",color:"blue-12",dense:"",onClick:we},{default:r(()=>[l(n(x),{name:"save",size:"xs",class:"q-pr-xs"}),n(d).screen.xs?p("",!0):(c(),C("span",Xe,"\uC800\uC7A5"))]),_:1})):p("",!0),u.value.length>0?(c(),D(n(k),{key:3,outline:"",color:"red",dense:"",onClick:_e,class:"q-pr-md"},{default:r(()=>[l(Ae,{color:"orange",floating:""},{default:r(()=>[b(ze(u.value.length),1)]),_:1}),l(n(x),{name:"delete",size:"xs",class:"q-pr-xs"}),b(),n(d).screen.xs?p("",!0):(c(),C("span",ea," \uC0AD\uC81C "))]),_:1})):p("",!0)]),_:1}),(c(),C("div",{key:J.value,style:ae({height:V.value+"px"})},[l(n(oe),{style:{width:"100%",height:"100%"},class:z(n(d).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),columnDefs:$.columns,rowData:g.rows,defaultColDef:j.def,rowSelection:U.value,onSelectionChanged:me,onGridReady:ne,"grid-options":be,rowDragManaged:!0,animateRows:!0,onRowDragMove:ve,onRowDragEnd:ge,onRowDragEnter:pe,onRowDragLeave:he},null,8,["class","columnDefs","rowData","defaultColDef","rowSelection"])],4)),l(Y,{spaced:""}),l(I,{class:"q-pa-lg"},{default:r(()=>[i("div",aa,[i("div",ta,[l(Ee,{readonly:S.value,disable:v.value,"stack-label":"","options-dense":"","label-color":"orange",modelValue:t.value.divCd,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.divCd=o),options:Z.value,"option-value":"commCd","option-label":"commNm","option-disable":"inactive","emit-value":"","map-options":"",label:"\uD56D\uBAA9\uBD84\uB958"},null,8,["readonly","disable","modelValue","options"])]),i("div",la,[l(te,{ref_key:"focusStart",ref:A,readonly:S.value,disable:v.value,modelValue:t.value.itemNm,"onUpdate:modelValue":[a[1]||(a[1]=o=>t.value.itemNm=o),Se],clearable:"",type:"text",color:"orange-13","label-color":"orange-13",label:"\uD3C9\uAC00\uD56D\uBAA9\uBA85",hint:`${ee.value} / 100\uC790 \uAE4C\uC9C0 \uC785\uB825\uD558\uC2E4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`},null,8,["readonly","disable","modelValue","hint"])]),i("div",oa,[l(te,{readonly:S.value,disable:v.value,modelValue:t.value.weight,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.weight=o),type:"number",color:"pink-12","label-color":"pink-12",label:"\uAC00\uC911\uCE58",hint:"\uAC00\uC911\uCE58\uB97C \uC124\uC815\uD558\uC138\uC694",rules:[o=>m.value-X.value+parseInt(o)<=100||"\uAC00\uC911\uCE58\uD569\uC774 100\uC774 \uB118\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."]},null,8,["readonly","disable","modelValue","rules"])])])]),_:1})]),_:1})])])]),_:1})]),_:1}))}};export{qa as default};
