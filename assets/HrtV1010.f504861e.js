import{Q as ee}from"./QItemLabel.848dda36.js";import{R as te,ad as X,r as h,U as R,V as U,W as o,n as l,aa as S,Y as r,a5 as _,a2 as N,Z as b,ab as ae,X as G,bu as L,$ as a,a0 as c,a8 as M,F as le,ag as oe,a7 as Z,b8 as ne,b9 as se,j as re,p as ie,k as de,o as ce,S as H,a6 as pe,a9 as ue,bE as me,af as he}from"./index.07fc3cde.js";import{Q as B}from"./QSelect.3c86eb28.js";import{Q as T}from"./QSpace.ddaf28ca.js";import{Q as fe}from"./QToolbar.e70c6bf5.js";/* empty css                        */import{A as ge}from"./main.esm.15e3c1e8.js";import"./SessionStorage.f1db57de.js";import{u as j}from"./use-quasar.9559018b.js";import{u as J}from"./setYearInfo.f0ebbaa1.js";import{Q as we}from"./QTooltip.63239899.js";import{Q as ve}from"./QBar.3120e686.js";import{p as xe}from"./print.22a271a6.js";import{u as P,w as _e}from"./xlsx.db07aefa.js";import"./QField.2ae85778.js";import"./QItemSection.345ae796.js";import"./QMenu.8bcf41ca.js";import"./position-engine.7c438a6d.js";import"./selection.ae892694.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const E=y=>(ne("data-v-b4f14f44"),y=y(),se(),y),be=E(()=>a("span",{class:"text-subtitle1 q-ml-sm"},"\uCD9C\uB825\uBB3C\uAD00\uB9AC\uD654\uBA74",-1)),ye=E(()=>a("span",{class:"text-bold text-subtitle1"},null,-1)),Ce={id:"printZone"},ke={class:"row q-px-xs"},Se=E(()=>a("span",{class:"text-h6"},"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00 \uD604\uD669",-1)),Ne={class:"text-h6"},Ve=E(()=>a("tr",null,[a("th",{rowspan:"1",colspan:"2"},"\uC18C\uC18D"),a("th",{rowspan:"2",colspan:"1"},"\uC131\uBA85"),a("th",{rowspan:"1",colspan:"2"},"\uB0B4\uC6A9"),a("th",{rowspan:"2",colspan:"1"},"\uD3C9\uAC00\uAE30\uC900"),a("th",{rowspan:"2",colspan:"1"},"\uAC00\uC911\uCE58"),a("th",{rowspan:"1",colspan:"2"},"\uC790\uAE30\uD3C9\uAC00"),a("th",{rowspan:"1",colspan:"2"},"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00")],-1)),De=E(()=>a("tr",null,[a("th",null,"\uC18C\uC18D"),a("th",null,"\uC9C1\uAE09"),a("th",null,"\uBAA9\uD45C\uB0B4\uC6A9"),a("th",null,"\uC131\uACFC\uB0B4\uC6A9"),a("th",null,"\uC790\uAE30\uD3C9\uAC00"),a("th",null,"\uC790\uAE30\uD658\uC0B0"),a("th",null,"\uC131\uACFC\uD3C9\uAC00"),a("th",null,"\uC131\uAF48\uD658\uC0B0")],-1)),qe={__name:"HrtV1010p",props:{rowData:Array},emits:["close"],setup(y,{emit:C}){const f=J(),p=j(),v=C,W=y;function V(){console.log("closeDialog called"),v("close")}const Y=()=>{xe({printable:"printZone",type:"html",css:["/src/css/print/hrt1010.css"],scanStyles:!1})};window.matchMedia("(prefers-color-scheme: dark)").matches?console.log("Dark mode is enabled"):console.log("Light mode is enabled");const D=()=>{p.dialog({dark:!0,title:"Excel \uC800\uC7A5",html:!0,message:"\uC5D1\uC140 \uD30C\uC77C\uB85C \uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",ok:{label:"\uC800\uC7A5",color:"primary"},cancel:{label:"\uB2EB\uAE30",color:"secondary"}}).onOk(()=>{$()}).onCancel(()=>{}).onDismiss(()=>{})},t=X({header:[],headProps:["deptNm","titlNm","empNm","targetDoc","workDoc","evaNm","weight","selfPoint","selfPointX","markPoint","markPointX"],headRow1:[{name:"\uC18C\uC18D\uD300",rowspan:1,colspan:2},{name:"\uC131\uBA85",rowspan:2,colspan:1,key:"empNm"},{name:"\uD3C9\uAC00\uB0B4\uC6A9",rowspan:1,colspan:2},{name:"\uD3C9\uAC00\uAE30\uC900",rowspan:2,colspan:1,key:"evaNm"},{name:"\uAC00\uC911\uCE58",rowspan:2,colspan:1,key:"weight"},{name:"\uC790\uAE30\uD3C9\uAC00",rowspan:1,colspan:2},{name:"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00",rowspan:1,colspan:2}],headRow2:[{name:"\uC18C\uC18D",rowspan:1,colspan:1,key:"deptNm"},{name:"\uC9C1\uAE09",rowspan:1,colspan:1,key:"titlNm"},{name:"\uBAA9\uD45C\uB0B4\uC6A9",rowspan:1,colspan:1,key:"targetDoc"},{name:"\uC131\uACFC\uB0B4\uC6A9",rowspan:1,colspan:1,key:"workDoc"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"selfPoint"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"selfPointX"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"markPoint"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"markPointX"}]}),$=()=>{t.header=[],t.header.push(t.headRow1),t.header.push(t.headRow2);let x={header:t.header,headProps:t.headProps};Q(W.rowData,x)},i=h([]),k=h(void 0),Q=(x,g)=>{let n=[];if(Array.isArray(g.headProps))n=g.headProps;else if(g.headProps==="header")for(let u of t.header)n.push(u.key);else n=Object.keys(x[0]);i.value=t.headProps,k.value=document.createElement("table");let q=[];Array.isArray(t.header[0])?q=t.header:q.push(t.header);let A=document.createElement("thead");for(let u of q){let m=document.createElement("tr");for(let w of u){let O=w.rowspan||"1",K=w.colspan||"1",F=document.createElement("th");F.setAttribute("rowspan",O),F.setAttribute("colspan",K),F.innerText=w.name,m.appendChild(F)}A.appendChild(m)}k.value.appendChild(A);let z=document.createElement("tbody");for(let u of x){let m=document.createElement("tr");for(let w of i.value){let O=document.createElement("td");O.innerText=u[w],m.appendChild(O)}z.appendChild(m)}k.value.appendChild(z);const I={raw:!0,type:"string"},e=P.table_to_sheet(k.value,I);e.A1.s={font:{color:{rgb:"FF0000"},bold:!0}};const s=P.decode_range(e["!ref"]);for(let u=s.s.r;u<=s.e.r;++u)for(let m=s.s.c;m<=s.e.c;++m){const w=P.encode_cell({r:u,c:m});!e[w]||(e[w].s={border:{top:{style:"thin",color:{rgb:"0000FF"}},bottom:{style:"thin",color:{rgb:"0000FF"}},left:{style:"thin",color:{rgb:"0000FF"}},right:{style:"thin",color:{rgb:"0000FF"}}}})}let d=P.book_new();P.book_append_sheet(d,e,"\uC131\uACFC\uD3C9\uAC00\uD604\uD669"),_e(d,"\uC131\uACFC\uD3C9\uAC00\uD604\uD669.xlsx")};return(x,g)=>(R(),U(Z,null,{default:o(()=>[l(S,{flat:"",bordered:""},{default:o(()=>[l(ve,null,{default:o(()=>[l(r(_),{name:"print"}),be,l(T),ye,l(T),l(r(N),{dense:"",flat:"",icon:"close",onClick:V},{default:o(()=>[l(we,null,{default:o(()=>[b(" \uB2EB\uAE30 ")]),_:1})]),_:1})]),_:1}),l(S,null,{default:o(()=>[l(ae,{align:"right",class:G(r(p).dark.isActive?"bg-grey-8 text-teal":"bg-blue-grey-1 text-teal")},{default:o(()=>[l(r(N),{outline:"",color:r(p).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:D},{default:o(()=>[l(r(_),{class:"q-mr-xs",name:"download",size:"xs"}),b(" \uC5D1\uC140 ")]),_:1},8,["color"]),l(r(N),{outline:"",color:r(p).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:Y},{default:o(()=>[l(r(_),{class:"q-mr-xs",name:"print",size:"xs"}),b(" \uCD9C\uB825 ")]),_:1},8,["color"]),l(r(N),{outline:"",color:r(p).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:V},{default:o(()=>[l(r(_),{class:"q-mr-xs",name:"close",size:"xs"}),b(" \uB2EB\uAE30 ")]),_:1},8,["color"])]),_:1},8,["class"]),l(L,{class:"q-pt-none"},{default:o(()=>[a("div",Ce,[a("div",ke,[Se,l(T),a("span",Ne,"\uAE30\uC900\uB144\uB3C4 : "+c(r(f).setYear)+"\uB144",1)]),a("table",null,[Ve,De,(R(!0),M(le,null,oe(W.rowData,n=>(R(),M("tr",{key:n.empCd},[a("td",null,c(n.deptNm),1),a("td",null,c(n.titlNm),1),a("td",null,c(n.empNm),1),a("td",null,c(n.targetDoc),1),a("td",null,c(n.workDoc),1),a("td",null,c(n.evaNm),1),a("td",null,c(n.weight),1),a("td",null,c(n.selfPoint),1),a("td",null,c(n.selfPointX),1),a("td",null,c(n.markPoint),1),a("td",null,c(n.markPointX),1)]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1}))}};var Pe=te(qe,[["__scopeId","data-v-b4f14f44"]]);const Re={class:""},Ee={class:"col-xs-12 col-sm-9 row"},We={class:"row q-gutter-x-xs"},Qe=45,at={__name:"HrtV1010",setup(y){const C=J(),f=X({rows:[]}),p=h(!1),v=h(145),W=h(90),V=j();function Y(){console.log("handleClose called"),p.value=!1}const D=h(300);re(()=>({height:`${D.value}px`}));const t=h({textValue:"",deptCd:null,titlCd:null,catgCd:null,deptOptions:null,titlOptions:null,catgOptions:null}),$=X({group:[{headerName:"#",minWidth:70,maxWidth:80,pinned:"left",sortable:!1,filter:!1,valueGetter:function(e){return e.node.rowIndex+1},cellStyle:e=>({textAlign:"center"})},{headerName:"\uC18C\uC18D",field:"deptNm",minWidth:105,maxWidth:105,cellStyle:e=>i(e.data)},{headerName:"\uC9C1\uAE09",field:"titlNm",minWidth:80,maxWidth:80,cellStyle:e=>i(e.data)},{headerName:"\uC131\uBA85",field:"empNm",minWidth:90,maxWidth:90,resizable:!0},{headerName:"\uD3C9\uAC00\uAD6C\uBD84",field:"evsNm",minWidth:105,maxWidth:105,cellStyle:e=>i(e.data)},{headerName:"\uBAA9\uD45C\uB0B4\uC6A9",field:"targetDoc",minWidth:150,cellStyle:e=>i(e.data)},{headerName:"\uC131\uACFC\uB0B4\uC6A9",field:"workDoc",minWidth:150,cellStyle:e=>i(e.data)},{headerName:"\uD3C9\uAC00\uAE30\uC900",field:"evaNm",minWidth:150,cellStyle:e=>i(e.data)},{headerName:"\uAC00\uC911\uCE58",field:"weight",minWidth:90,maxWidth:90,cellStyle:e=>i(e.data)},{headerName:"\uC790\uAE30\uD3C9\uAC00",field:"selfPoint",minWidth:100,maxWidth:100,cellStyle:e=>i(e.data)},{headerName:"\uC790\uAE30\uD658\uC0B0",field:"selfPointX",minWidth:100,maxWidth:100,cellStyle:e=>i(e.data)},{headerName:"\uC131\uACFC\uD3C9\uAC00",field:"markPoint",minWidth:100,maxWidth:100,cellStyle:e=>i(e.data)},{headerName:"\uC131\uACFC\uD658\uC0B0",field:"markPointX",minWidth:100,maxWidth:100,cellStyle:e=>i(e.data)}]}),i=e=>({color:"dark"});ie(()=>{window.removeEventListener("resize",g)}),de(()=>{q(),A(),z()}),ce(()=>{window.addEventListener("resize",g),g()});const k=h([]),Q=h(0),x=e=>(Q.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),g=()=>{D.value=window.innerHeight-Q.value},n=async()=>{try{const e=await H.post("/api/hrt/hrt1010_list",{paramSetYear:C.setYear,paramDeptCd:t.value.deptCd,paramTitlCd:t.value.titlCd,paramCatgCd:t.value.catgCd,paramSearchValue:t.value.textValue});if(f.rows=e.data.data,f.rows.length===0)v.value=145;else{v.value=W.value+f.rows.length*Qe;const s=D.value-180;v.value>s&&(v.value=s)}}catch(e){console.error("Error fetching users:",e)}};async function q(){try{const e=await H.post("/api/mst/dept_option_list",{paramSetYear:C.setYear});t.value.deptOptions=e.data.data,t.value.deptOptions.unshift({deptCd:"",deptNm:"\uC804\uCCB4"}),t.value.deptCd=""}catch(e){console.error("Error fetching users:",e)}}async function A(){try{const e=await H.post("/api/mst/titl_option_list",{paramSetYear:C.setYear});t.value.titlOptions=e.data.data,t.value.titlOptions.unshift({titlCd:"",titlNm:"\uC804\uCCB4"}),t.value.titlCd=""}catch(e){console.error("Error fetching users:",e)}}async function z(){try{const e=await H.post("/api/mst/catg_option_list",{paramSetYear:C.setYear});t.value.catgOptions=e.data.data,t.value.catgOptions.unshift({catgCd:"",catgNm:"\uC804\uCCB4"}),t.value.catgCd=""}catch(e){console.error("Error fetching users:",e)}}const I={columnDefs:$.group,defaultColDef:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1},rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,enableRangeSelection:!0,suppressRowClickSelection:!1,animateRows:!0,suppressHorizontalScroll:!0,localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."},getRowStyle:function(e){return e.node.rowPinned?{"font-weight":"bold",background:"#dddddd"}:{"text-align":"left"}},getRowHeight:function(e){return e.node.rowPinned?45:30},onGridReady:function(e){e.api.sizeColumnsToFit()},onGridSizeChanged:function(e){e.api.sizeColumnsToFit()},onRowEditingStarted:function(e){console.log("never called - not doing row editing")},onRowEditingStopped:function(e){console.log("never called - not doing row editing")},onCellEditingStarted:function(e){console.log("cellEditingStarted")},onCellEditingStopped:function(e){console.log("cellEditingStopped")},onRowClicked:function(e){console.log("onRowClicked"),k.value=e.api.getSelectedRows()},onCellClicked:function(e){console.log("onCellClicked")},isRowSelectable:function(e){return!0},onSelectionChanged:function(e){console.log("onSelectionChanged")},onSortChanged:function(e){console.log("onSortChanged")},onCellValueChanged:function(e){console.log("onCellValueChanged")},getRowNodeId:function(e){return null},setPinnedTopRowData:function(e){return null},setPinnedBottomRowData:function(e){return null},debug:!1};return(e,s)=>(R(),U(Z,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":x},{default:o(()=>[l(S,{class:"q-pa-sm"},{default:o(()=>[l(L,{class:G(["text-center q-pa-sm q-mb-sm",r(V).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:o(()=>[l(ee,{class:"text-h6"},{default:o(()=>[b("\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00 \uD604\uD669 ")]),_:1})]),_:1},8,["class"]),a("div",Re,[l(S,{class:"q-pa-sm"},{default:o(()=>[l(fe,{class:"row q-px-none q-pt-none"},{default:o(()=>[a("div",Ee,[l(B,{"stack-label":"","options-dense":"",class:"q-px-md q-mr-xs","label-color":"orange",modelValue:t.value.deptCd,"onUpdate:modelValue":[s[0]||(s[0]=d=>t.value.deptCd=d),n],options:t.value.deptOptions,"option-value":"deptCd","option-label":"deptNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC18C\uC18D\uD300"},null,8,["modelValue","options"]),l(B,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.titlCd,"onUpdate:modelValue":[s[1]||(s[1]=d=>t.value.titlCd=d),n],options:t.value.titlOptions,"option-value":"titlCd","option-label":"titlNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"90px"},label:"\uC9C1\uAE09"},null,8,["modelValue","options"]),l(B,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.catgCd,"onUpdate:modelValue":[s[2]||(s[2]=d=>t.value.catgCd=d),n],options:t.value.catgOptions,"option-value":"catgCd","option-label":"catgNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC9C1\uBD84\uB958"},null,8,["modelValue","options"]),l(pe,{"stack-label":"","label-color":"orange","bottom-slots":"",modelValue:t.value.textValue,"onUpdate:modelValue":[s[4]||(s[4]=d=>t.value.textValue=d),n],label:"\uAC80\uC0C9(\uC131\uBA85)",class:"q-pb-none",style:{width:"110px"}},{append:o(()=>[t.value.textValue!==""?(R(),U(r(_),{key:0,name:"close",onClick:s[3]||(s[3]=d=>t.value.textValue=""),size:"xs",class:"cursor-pointer q-pt-md"})):ue("",!0)]),_:1},8,["modelValue"])]),l(T),a("div",We,[l(r(N),{outline:"",color:"grey",onClick:n,class:"q-px-sm"},{default:o(()=>[l(r(_),{name:"search",size:"xs",class:"q-mr-xs"}),b(" \uC870\uD68C ")]),_:1}),l(r(N),{disable:f.rows.length===0,outline:"",color:"teal",onClick:s[5]||(s[5]=d=>p.value=!0),class:"q-px-sm"},{default:o(()=>[l(r(_),{name:"download",size:"xs",class:"q-mr-xs"}),b(" \uC5D1\uC140/\uCD9C\uB825 ")]),_:1},8,["disable"])])]),_:1}),l(S,{class:"q-mt-sm"},{default:o(()=>[a("div",{style:me({height:v.value+"px"})},[l(r(ge),{style:{width:"100%",height:"100%"},class:G(r(V).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),rowData:f.rows,"grid-options":I},null,8,["class","rowData"])],4)]),_:1})]),_:1})])]),_:1}),l(he,{persistent:"","full-height":"","full-width":"",modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=d=>p.value=d)},{default:o(()=>[l(S,{class:"q-pa-none q-ma-none"},{default:o(()=>[l(L,{class:"q-pa-none q-ma-none"},{default:o(()=>[l(Pe,{rowData:f.rows,onClose:Y},null,8,["rowData"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{at as default};
