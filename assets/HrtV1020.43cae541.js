import{Q as ee}from"./QItemLabel.4a9918b4.js";import{R as te,ad as B,r as h,U as R,V as X,W as o,n as l,aa as V,Y as s,a5 as b,a2 as q,Z as x,ab as le,X as U,bu as G,$ as a,a0 as p,a8 as L,F as ae,ag as oe,a7 as Z,b8 as ne,b9 as se,j as re,p as ie,k as de,o as ce,S as T,a6 as pe,a9 as ue,bE as me,af as he}from"./index.7f77393b.js";import{Q as I}from"./QSelect.114f76c2.js";import{Q as W}from"./QSpace.d904af94.js";import{Q as fe}from"./QToolbar.963c8e72.js";/* empty css                        */import{A as ge}from"./main.esm.3000f5c9.js";import"./SessionStorage.b85a400f.js";import{u as j}from"./use-quasar.49a49e75.js";import{u as J}from"./setYearInfo.8b7f3a45.js";import{Q as ve}from"./QTooltip.472888d5.js";import{Q as we}from"./QBar.aa6ab1e6.js";import{p as _e}from"./print.22a271a6.js";import{u as P,w as be}from"./xlsx.db07aefa.js";import"./QField.5fb0fda7.js";import"./QItemSection.f93cdc59.js";import"./QMenu.0a3c81a9.js";import"./position-engine.150cbc63.js";import"./selection.004dbe93.js";import"./rtl.276c3f1b.js";import"./_commonjsHelpers.b8add541.js";const A=C=>(ne("data-v-53ac453d"),C=C(),se(),C),xe=A(()=>a("span",{class:"text-subtitle1 q-ml-sm"},"\uCD9C\uB825\uBB3C\uAD00\uB9AC\uD654\uBA74",-1)),Ce=A(()=>a("span",{class:"text-bold text-subtitle1"},null,-1)),ye={id:"printZone"},Se={class:"row q-px-xs"},ke=A(()=>a("span",{class:"text-h6"},"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00 \uD604\uD669",-1)),Ve={class:"text-h6"},qe=A(()=>a("tr",null,[a("th",{rowspan:"1",colspan:"2"},"\uBD80\uC11C"),a("th",{rowspan:"2",colspan:"1"},"\uC131\uBA85"),a("th",{rowspan:"1",colspan:"2"},"\uC790\uAE30\uD3C9\uAC00"),a("th",{rowspan:"1",colspan:"2"},"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00"),a("th",{rowspan:"1",colspan:"2"},"\uD300\uD3C9\uAC00\uC810\uC218\uBC18\uC601")],-1)),Ne=A(()=>a("tr",null,[a("th",null,"\uC18C\uC18D\uD300"),a("th",null,"\uC9C1\uAE09"),a("th",null,"\uC790\uAE30\uD3C9\uAC00"),a("th",null,"\uC790\uAE30\uD658\uC0B0"),a("th",null,"\uC131\uACFC\uD3C9\uAC00"),a("th",null,"\uC131\uAF48\uD658\uC0B0"),a("th",null,"\uD569\uC0B0\uC810\uC218"),a("th",null,"\uBC18\uC601\uC810\uC218")],-1)),De={__name:"HrtV1020p",props:{rowData:Array},emits:["close"],setup(C,{emit:y}){const f=J(),c=j(),w=y,E=C;function S(){console.log("closeDialog called"),w("close")}const Y=()=>{_e({printable:"printZone",type:"html",css:["/src/css/print/hrt1020.css"],scanStyles:!1})};window.matchMedia("(prefers-color-scheme: dark)").matches?console.log("Dark mode is enabled"):console.log("Light mode is enabled");const N=()=>{c.dialog({dark:!0,title:"Excel \uC800\uC7A5",html:!0,message:"\uC5D1\uC140 \uD30C\uC77C\uB85C \uC800\uC7A5 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?",ok:{label:"\uC800\uC7A5",color:"primary"},cancel:{label:"\uB2EB\uAE30",color:"secondary"}}).onOk(()=>{M()}).onCancel(()=>{}).onDismiss(()=>{})},t=B({header:[],headProps:["deptNm","titlNm","empNm","totalSelfPoint","totalSelfPointX","totalMarkPoint","totalMarkPointX","totalDeptSum","totalResultAvg"],headRow1:[{name:"\uC18C\uC18D\uD300",rowspan:1,colspan:2},{name:"\uC131\uBA85",rowspan:2,colspan:1,key:"empNm"},{name:"\uC790\uAE30\uD3C9\uAC00",rowspan:1,colspan:2},{name:"\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00",rowspan:1,colspan:2},{name:"\uD300\uD3C9\uAC00\uC810\uC218\uBC18\uC601",rowspan:1,colspan:2}],headRow2:[{name:"\uC18C\uC18D",rowspan:1,colspan:1,key:"deptNm"},{name:"\uC9C1\uAE09",rowspan:1,colspan:1,key:"titlNm"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"totalSelfPoint"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"totalSelfPointX"},{name:"\uD3C9\uAC00\uC810\uC218",rowspan:1,colspan:1,key:"totalMarkPoint"},{name:"\uD658\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"totalMarkPointX"},{name:"\uD569\uC0B0\uC810\uC218",rowspan:1,colspan:1,key:"totalDeptSum"},{name:"\uBC18\uC601\uC810\uC218",rowspan:1,colspan:1,key:"totalResultAvg"}]}),M=()=>{t.header=[],t.header.push(t.headRow1),t.header.push(t.headRow2);let _={header:t.header,headProps:t.headProps};Q(E.rowData,_)},d=h([]),k=h(void 0),Q=(_,g)=>{let r=[];if(Array.isArray(g.headProps))r=g.headProps;else if(g.headProps==="header")for(let u of t.header)r.push(u.key);else r=Object.keys(_[0]);d.value=t.headProps,k.value=document.createElement("table");let D=[];Array.isArray(t.header[0])?D=t.header:D.push(t.header);let z=document.createElement("thead");for(let u of D){let m=document.createElement("tr");for(let v of u){let F=v.rowspan||"1",K=v.colspan||"1",H=document.createElement("th");H.setAttribute("rowspan",F),H.setAttribute("colspan",K),H.innerText=v.name,m.appendChild(H)}z.appendChild(m)}k.value.appendChild(z);let O=document.createElement("tbody");for(let u of _){let m=document.createElement("tr");for(let v of d.value){let F=document.createElement("td");F.innerText=u[v],m.appendChild(F)}O.appendChild(m)}k.value.appendChild(O);const $={raw:!0,type:"string"},e=P.table_to_sheet(k.value,$);e.A1.s={font:{color:{rgb:"FF0000"},bold:!0}};const n=P.decode_range(e["!ref"]);for(let u=n.s.r;u<=n.e.r;++u)for(let m=n.s.c;m<=n.e.c;++m){const v=P.encode_cell({r:u,c:m});!e[v]||(e[v].s={border:{top:{style:"thin",color:{rgb:"0000FF"}},bottom:{style:"thin",color:{rgb:"0000FF"}},left:{style:"thin",color:{rgb:"0000FF"}},right:{style:"thin",color:{rgb:"0000FF"}}}})}let i=P.book_new();P.book_append_sheet(i,e,"\uC131\uACFC\uD3C9\uAC00\uC9D1\uACC4\uD45C"),be(i,"\uC131\uACFC\uD3C9\uAC00\uC9D1\uACC4\uD45C.xlsx")};return(_,g)=>(R(),X(Z,null,{default:o(()=>[l(V,{flat:"",bordered:""},{default:o(()=>[l(we,null,{default:o(()=>[l(s(b),{name:"print"}),xe,l(W),Ce,l(W),l(s(q),{dense:"",flat:"",icon:"close",onClick:S},{default:o(()=>[l(ve,null,{default:o(()=>[x(" \uB2EB\uAE30 ")]),_:1})]),_:1})]),_:1}),l(V,null,{default:o(()=>[l(le,{align:"right",class:U(s(c).dark.isActive?"bg-grey-8 text-teal":"bg-blue-grey-1 text-teal")},{default:o(()=>[l(s(q),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:N},{default:o(()=>[l(s(b),{class:"q-mr-xs",name:"download",size:"xs"}),x(" \uC5D1\uC140 ")]),_:1},8,["color"]),l(s(q),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:Y},{default:o(()=>[l(s(b),{class:"q-mr-xs",name:"print",size:"xs"}),x(" \uCD9C\uB825 ")]),_:1},8,["color"]),l(s(q),{outline:"",color:s(c).dark.isActive?"teal-3":"primary",class:"q-px-sm",onClick:S},{default:o(()=>[l(s(b),{class:"q-mr-xs",name:"close",size:"xs"}),x(" \uB2EB\uAE30 ")]),_:1},8,["color"])]),_:1},8,["class"]),l(G,{class:"q-pt-none"},{default:o(()=>[a("div",ye,[a("div",Se,[ke,l(W),a("span",Ve,"\uAE30\uC900\uB144\uB3C4 : "+p(s(f).setYear)+"\uB144",1)]),a("table",null,[qe,Ne,(R(!0),L(ae,null,oe(E.rowData,r=>(R(),L("tr",{key:r.empCd},[a("td",null,p(r.deptNm),1),a("td",null,p(r.titlNm),1),a("td",null,p(r.empNm),1),a("td",null,p(r.totalSelfPoint),1),a("td",null,p(r.totalSelfPointX),1),a("td",null,p(r.totalMarkPoint),1),a("td",null,p(r.totalMarkPointX),1),a("td",null,p(r.totalDeptSum),1),a("td",null,p(r.totalResultAvg),1)]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1}))}};var Pe=te(De,[["__scopeId","data-v-53ac453d"]]);const Re={class:""},Ae={class:"col-xs-12 col-sm-9 row"},Ee={class:"row q-gutter-x-xs"},Qe=45,lt={__name:"HrtV1020",setup(C){const y=J(),f=B({rows:[]}),c=h(!1),w=h(145),E=h(90),S=j();function Y(){console.log("handleClose called"),c.value=!1}const N=h(300);re(()=>({height:`${N.value}px`}));const t=h({textValue:"",deptCd:null,titlCd:null,catgCd:null,deptOptions:null,titlOptions:null,catgOptions:null}),M=B({group:[{headerName:"#",minWidth:70,maxWidth:80,pinned:"left",sortable:!1,filter:!1,valueGetter:function(e){return e.node.rowIndex+1},cellStyle:e=>({textAlign:"center"})},{headerName:"\uC18C\uC18D",field:"deptNm",minWidth:105,cellStyle:e=>d(e.data)},{headerName:"\uC9C1\uAE09",field:"titlNm",minWidth:80,cellStyle:e=>d(e.data)},{headerName:"\uC131\uBA85",field:"empNm",minWidth:90,resizable:!0},{headerName:"\uD3C9\uAC00\uAD6C\uBD84",field:"evsNm",minWidth:105,cellStyle:e=>d(e.data)},{headerName:"\uC790\uAE30\uD3C9\uAC00",field:"totalSelfPoint",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uC790\uAE30\uD658\uC0B0",field:"totalSelfPointX",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uC131\uACFC\uD3C9\uAC00",field:"totalMarkPoint",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uC131\uACFC\uD658\uC0B0",field:"totalMarkPointX",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uD300\uC810\uC218",field:"totalDeptSum",minWidth:100,cellStyle:e=>d(e.data)},{headerName:"\uD300\uBC18\uC601\uC810\uC218",field:"totalResultAvg",minWidth:100,cellStyle:e=>S.dark.isActive?{color:"orange"}:{color:"blue"}}]}),d=e=>({color:"dark"});ie(()=>{window.removeEventListener("resize",g)}),de(()=>{D(),z(),O()}),ce(()=>{window.addEventListener("resize",g),g()});const k=h([]),Q=h(0),_=e=>(Q.value=e,{minHeight:e?`calc(100vh - ${e}px)`:"100vh"}),g=()=>{N.value=window.innerHeight-Q.value},r=async()=>{try{const e=await T.post("/api/hrt/hrt1020_list",{paramSetYear:y.setYear,paramDeptCd:t.value.deptCd,paramTitlCd:t.value.titlCd,paramCatgCd:t.value.catgCd,paramSearchValue:t.value.textValue});if(f.rows=e.data.data,f.rows.length===0)w.value=145;else{w.value=E.value+f.rows.length*Qe;const n=N.value-180;w.value>n&&(w.value=n)}}catch(e){console.error("Error fetching users:",e)}};async function D(){try{const e=await T.post("/api/mst/dept_option_list",{paramSetYear:y.setYear});t.value.deptOptions=e.data.data,t.value.deptOptions.unshift({deptCd:"",deptNm:"\uC804\uCCB4"}),t.value.deptCd=""}catch(e){console.error("Error fetching users:",e)}}async function z(){try{const e=await T.post("/api/mst/titl_option_list",{paramSetYear:y.setYear});t.value.titlOptions=e.data.data,t.value.titlOptions.unshift({titlCd:"",titlNm:"\uC804\uCCB4"}),t.value.titlCd=""}catch(e){console.error("Error fetching users:",e)}}async function O(){try{const e=await T.post("/api/mst/catg_option_list",{paramSetYear:y.setYear});t.value.catgOptions=e.data.data,t.value.catgOptions.unshift({catgCd:"",catgNm:"\uC804\uCCB4"}),t.value.catgCd=""}catch(e){console.error("Error fetching users:",e)}}const $={columnDefs:M.group,defaultColDef:{flex:1,sortable:!0,filter:!0,floatingFilter:!1,editable:!1},rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,enableRangeSelection:!0,suppressRowClickSelection:!1,animateRows:!0,suppressHorizontalScroll:!0,localeText:{noRowsToShow:"\uC870\uD68C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."},getRowStyle:function(e){return e.node.rowPinned?{"font-weight":"bold",background:"#dddddd"}:{"text-align":"left"}},getRowHeight:function(e){return e.node.rowPinned?45:30},onGridReady:function(e){e.api.sizeColumnsToFit()},onGridSizeChanged:function(e){e.api.sizeColumnsToFit()},onRowEditingStarted:function(e){console.log("never called - not doing row editing")},onRowEditingStopped:function(e){console.log("never called - not doing row editing")},onCellEditingStarted:function(e){console.log("cellEditingStarted")},onCellEditingStopped:function(e){console.log("cellEditingStopped")},onRowClicked:function(e){console.log("onRowClicked"),k.value=e.api.getSelectedRows()},onCellClicked:function(e){console.log("onCellClicked")},isRowSelectable:function(e){return!0},onSelectionChanged:function(e){console.log("onSelectionChanged")},onSortChanged:function(e){console.log("onSortChanged")},onCellValueChanged:function(e){console.log("onCellValueChanged")},getRowNodeId:function(e){return null},setPinnedTopRowData:function(e){return null},setPinnedBottomRowData:function(e){return null},debug:!1};return(e,n)=>(R(),X(Z,{class:"q-pa-xs-xs q-pa-sm-md","style-fn":_},{default:o(()=>[l(V,{class:"q-pa-sm"},{default:o(()=>[l(G,{class:U(["text-center q-pa-sm q-mb-sm",s(S).dark.isActive?"bg-teal-7":"bg-teal-3"])},{default:o(()=>[l(ee,{class:"text-h6"},{default:o(()=>[x("\uBAA9\uD45C\uC131\uACFC\uD3C9\uAC00 \uC9D1\uACC4\uD45C ")]),_:1})]),_:1},8,["class"]),a("div",Re,[l(V,{class:"q-pa-sm"},{default:o(()=>[l(fe,{class:"row q-px-none q-pt-none"},{default:o(()=>[a("div",Ae,[l(I,{"stack-label":"","options-dense":"",class:"q-px-md q-mr-xs","label-color":"orange",modelValue:t.value.deptCd,"onUpdate:modelValue":[n[0]||(n[0]=i=>t.value.deptCd=i),r],options:t.value.deptOptions,"option-value":"deptCd","option-label":"deptNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC18C\uC18D\uD300"},null,8,["modelValue","options"]),l(I,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.titlCd,"onUpdate:modelValue":[n[1]||(n[1]=i=>t.value.titlCd=i),r],options:t.value.titlOptions,"option-value":"titlCd","option-label":"titlNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"90px"},label:"\uC9C1\uAE09"},null,8,["modelValue","options"]),l(I,{"stack-label":"","options-dense":"",class:"q-px-md","label-color":"orange",modelValue:t.value.catgCd,"onUpdate:modelValue":[n[2]||(n[2]=i=>t.value.catgCd=i),r],options:t.value.catgOptions,"option-value":"catgCd","option-label":"catgNm","option-disable":"inactive","emit-value":"","map-options":"",style:{"min-width":"100px"},label:"\uC9C1\uBD84\uB958"},null,8,["modelValue","options"]),l(pe,{"stack-label":"","label-color":"orange","bottom-slots":"",modelValue:t.value.textValue,"onUpdate:modelValue":[n[4]||(n[4]=i=>t.value.textValue=i),r],label:"\uAC80\uC0C9(\uC131\uBA85)",class:"q-pb-none",style:{width:"110px"}},{append:o(()=>[t.value.textValue!==""?(R(),X(s(b),{key:0,name:"close",onClick:n[3]||(n[3]=i=>t.value.textValue=""),size:"xs",class:"cursor-pointer q-pt-md"})):ue("",!0)]),_:1},8,["modelValue"])]),l(W),a("div",Ee,[l(s(q),{outline:"",color:"grey",onClick:r,class:"q-px-sm"},{default:o(()=>[l(s(b),{name:"search",size:"xs",class:"q-mr-xs"}),x(" \uC870\uD68C ")]),_:1}),l(s(q),{disable:f.rows.length===0,outline:"",color:"teal",onClick:n[5]||(n[5]=i=>c.value=!0),class:"q-px-sm"},{default:o(()=>[l(s(b),{name:"download",size:"xs",class:"q-mr-xs"}),x(" \uC5D1\uC140/\uCD9C\uB825 ")]),_:1},8,["disable"])])]),_:1}),l(V,{class:"q-mt-sm"},{default:o(()=>[a("div",{style:me({height:w.value+"px"})},[l(s(ge),{style:{width:"100%",height:"100%"},class:U(s(S).dark.isActive?"ag-theme-alpine-dark":"ag-theme-alpine"),rowData:f.rows,"grid-options":$},null,8,["class","rowData"])],4)]),_:1})]),_:1})])]),_:1}),l(he,{persistent:"","full-height":"","full-width":"",modelValue:c.value,"onUpdate:modelValue":n[6]||(n[6]=i=>c.value=i)},{default:o(()=>[l(V,{class:"q-pa-none q-ma-none"},{default:o(()=>[l(G,{class:"q-pa-none q-ma-none"},{default:o(()=>[l(Pe,{rowData:f.rows,onClose:Y},null,8,["rowData"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{lt as default};
